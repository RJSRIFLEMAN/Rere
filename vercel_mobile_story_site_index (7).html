<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Dedek Story</title>
  <meta name="theme-color" content="#0a0f1f" />
  <style>
    :root{
      --teal:#16c79a;
      --teal-2:#12a384;
      --bg-dark:#0a0f1f;
      --text:#f6f7fb;
      --muted:#b9c3cf;
      --card-bg:rgba(15,18,28,.55);
      --blur:18px;
      --radius:22px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; color:var(--text); background:var(--bg-dark); overflow:hidden}

    /* Background layers */
    .bg{position:fixed; inset:0; z-index:-2; background:#000}
    #bgVideo,#bgImage{position:absolute; inset:0; width:100%; height:100%; object-fit:cover}
    #bgImage{display:none}
    .bg-gradient{display:none; position:absolute; inset:0; background: linear-gradient(135deg, #0b1d3b 0%, #0a142c 50%, #050a15 100%)}
    .vignette{position:absolute; inset:0; z-index:-1; pointer-events:none; background:radial-gradient(80% 60% at 50% 50%, transparent 62%, rgba(0,0,0,.42) 100%)}

    /* Page */
    .phone{position:relative; width:100vw; height:100dvh; display:flex; align-items:center; justify-content:center; padding:16px}

    .card{width:min(92vw,420px); height:min(90dvh,760px); display:flex; flex-direction:column; gap:14px; background:var(--card-bg); backdrop-filter: blur(var(--blur)); -webkit-backdrop-filter: blur(var(--blur)); border-radius:28px; padding:18px 16px 16px; border:1px solid rgba(255,255,255,.08); box-shadow:0 10px 40px rgba(0,0,0,.45)}
    .card.card--invisible{background:transparent; border-color:transparent; box-shadow:none; backdrop-filter:none; -webkit-backdrop-filter:none}

    .title{font-weight:800; line-height:1.05; letter-spacing:.2px; font-size:clamp(28px,7vw,48px); margin:2px 6px 0; text-shadow:0 2px 14px rgba(0,0,0,.35)}
    .subtitle{margin:0 6px; color:var(--muted); font-size:14px}

    .scrollbox{flex:1 1 auto; overflow:auto; margin:6px; padding:14px 10px; background:rgba(0,0,0,.22); border-radius:var(--radius); border:1px solid rgba(255,255,255,.08); line-height:1.6; font-size:15px; scrollbar-width:thin}
    .scrollbox::-webkit-scrollbar{width:6px}
    .scrollbox::-webkit-scrollbar-thumb{background:rgba(255,255,255,.22); border-radius:8px}

    .cta{display:flex; gap:10px; align-items:center; justify-content:space-between; padding:8px; margin:0 6px}
    .btn{appearance:none; -webkit-appearance:none; border:0; cursor:pointer; padding:14px 18px; border-radius:18px; font-weight:700; background:linear-gradient(135deg,var(--teal),var(--teal-2)); color:#02130f; box-shadow:0 8px 24px rgba(18,195,150,.36); transition:transform .08s ease, filter .2s ease; text-align:center; text-decoration:none}
    .cta .btn{flex:1 1 auto}
    .btn:active{transform:translateY(1px)}

    .hint{font-size:12px; color:var(--muted); text-align:center; margin-top:2px}

    /* Overlays for 0 & 6 */
  .overlay{position:absolute; inset:0; display:flex; align-items:center; justify-content:center;}
  #introOverlay { pointer-events: none; }
  #endOverlay { z-index: 9999; pointer-events: auto; }
    .overlay .intro-block{display:flex; flex-direction:column; align-items:center; gap:6px}
    .overlay h1{margin:0; font-size: clamp(36px, 9vw, 64px); font-weight:900; text-shadow:0 6px 28px rgba(0,0,0,.55)}
    .overlay p{margin:0; font-size: clamp(14px, 4vw, 18px); color:var(--muted)}

    /* Safe area */
    .safe{padding-bottom:max(8px, env(safe-area-inset-bottom))}
  </style>
</head>
<body>
  <div class="bg" aria-hidden="true">
    <video id="bgVideo" playsinline muted loop preload="auto"></video>
    <img id="bgImage" alt="Background" />
    <div class="bg-gradient" id="bgGrad"></div>
    <div class="vignette"></div>
  </div>

  <!-- Intro (Bagian 0) tanpa card -->
  <div id="introOverlay" class="overlay">
    <div class="intro-block">
      <h1 id="introTitle">Hai, Dedek Rere</h1>
      <p id="introSub">- Abang Raja</p>
    </div>
  </div>
  <!-- End (Bagian 6) tanpa card -->
  <div id="endOverlay" class="overlay" hidden>
    <div style="display:flex; flex-direction:column; align-items:center; gap:10px; pointer-events:auto;">
      <h1 style="margin-bottom:0;">Pax Vobiscum</h1>
      <div style="font-size:18px; color:var(--muted); margin-bottom:12px;">Damai Beserta Kamu</div>
      <div class="cta safe" style="width:100%; justify-content:center;">
        <button class="btn" id="spotifyBtn" style="font-size:18px; min-width:120px;">Abang Sayang Dedek Rere</button>
      </div>
    </div>
  </div>

  <main class="phone">
    <section class="card" id="card" role="region" aria-live="polite">
      <h1 class="title" id="title"></h1>
      <p class="subtitle" id="subtitle"></p>
      <div class="scrollbox" id="content" hidden></div>
      <div class="cta safe"><button class="btn" id="nextBtn">Lanjut ➜</button></div>
      <div class="hint" id="hint">Re Abang sesayang itu sama Kamu.</div>
    </section>
  </main>

  <audio id="bgAudio" preload="auto" src="kami-rendahkan-diri-rere-raja_IjEzBAX3.aac"></audio>

  <script>
  const sections = [
    {id:0, kind:'intro', title:'Hai, Dedek Rere', subtitle:'- Abang Raja', type:'video', media:'Untitled design.mp4', body:''},
    {id:1, kind:'text', title:'Keluhan', type:'video', media:'Untitled design.mp4', body:`Keluhan adalah semua keresahan dan perasaan akan sesuatu yang menjengkelkan, tidak mengenakan, tidak membuat nyaman dan sebagainya. Dedek, Abang percaya pada setiap keluhan yang kamu sampaikan kamu melepaskan seluruh rasa dan keresahan kamu. Abang senang ketika Abang bisa jadi tempat dan wadah dedek untuk semua rasa itu, ketika dedek cerita dan berkeluh kesah Abang tau apa yg dedek rasakan, Abang tau apa yang dedek alami dan itulah salah satu aku bisa berterimakasih kepada Kamu Rereku. Aku akan sangat sedih ketika kamu berhenti bercerita tentang hal itu, memaknai dan mempelajari hingga pada tahap melatih mental bukanlah hal yang mudah re, ingatlah aku disini untuk kamu ceritakan apapun itu agar aku tau kehidupan jantung ke 2 Abang, ya Rere. Jangan berhenti bercerita adik meskipun cerita itu adalah keluhan sekalipun, aku mohon dik.`},
    {id:2, kind:'text', title:'Bodoamat', type:'video', media:'Untitled design (1).mp4', body:`Terkadang kita perlu bersikap seolah tidak peduli re, tidak akan ada habisnya ketika kamu mencoba untuk membahagiakan semua orang. Karena kamu hanyalah manusia dan akupun manusia kita punya pemikiran yang berbeda dan untuk aji dan beberapa orang sejenisnya merasa merekalah yg paling benar. Hal seperti itulah yang harusnya kita hindari dan tidak perlu kita ambil pusing dek, karena itu hanya akan membuang buang waktu saja.`},
    {id:3, kind:'text', title:'Mental', type:'video', media:'Untitled design (1).mp4', body:`adikku, aku belum pernah berkata kata sekeras ini kepadamu. Seharusnya penyampaian yang lembut dan komunikatif menjadi gaya bicaraku disini. Namun, tampaknya aku kecewa dan sakit hati akan argumentasi mu itu, aku minta maaf jikalau ini membuatmu takut seolah aku memarahi dirimu dan membuat engkau merass kecil dan lemah. Aku tdiak bermaksud membuat kmu panik, cemas, atau bahkan takut, aku minta maaf atas smua itu. Namun, aku percaya inilah proses menjadi sesek re. Kesalah pahaman seringkali terjadi, tapi aku yakin dengan komunikasi dan interaksi yang ada kita akan tetap bersama melewati segala rintangan dan cobaan.`},
    {id:4, kind:'text', title:"That's all", type:'video', media:'Untitled design (2).mp4', body:`Kamu tidak merusak apapun re, aku menghargai ini sebagai proses kamu dalam berfikir kritis dan mencoba memahami apa yang terjadi, analisis komparatif yang kamu lakukan mungkin kurang sesuai bagi aku, namun kamu sudah berusaha dengan baik dan telah berani untuk menyampaikan itu kepadaku dengan jujur. Tidak ada dari 100 poin yang kamu rusak re, kamu sempurna apa adanya. Tetap rasional dalam berfikir re, hidup masih panjang mungkin aku hanya salah satu dari banyaknya orang yang akan ngata ngatain kamu kayak gini. Tapi, percayalah kamu berharga Dimata Tuhan dan Dimata Abang. Abang sayang Dedek Rere.`},
    {id:5, kind:'image', title:'DONOT', type:'image', media:'DONOT.jpg', body:''},
    {id:6, kind:'end', title:'Pax Vobiscum', type:'gradient', media:'', body:''}
  ];

  const bgVideo=document.getElementById('bgVideo');
  const bgImage=document.getElementById('bgImage');
  const bgGrad=document.getElementById('bgGrad');
  const card=document.getElementById('card');
  const titleEl=document.getElementById('title');
  const subtitle=document.getElementById('subtitle');
  const content=document.getElementById('content');
  const nextBtn=document.getElementById('nextBtn');
  const hint=document.getElementById('hint');
  const bgAudio=document.getElementById('bgAudio');
  const introOverlay=document.getElementById('introOverlay');
  const introTitle=document.getElementById('introTitle');
  const introSub=document.getElementById('introSub');
  const endOverlay=document.getElementById('endOverlay');

  let i=0;

  function preload(path){
    const ext=(path||'').split('.').pop();
    if(['mp4','webm','mov'].includes(ext)){const v=document.createElement('video'); v.preload='auto'; v.src=path; v.muted=true; v.playsInline=true; v.load();}
    else if(['jpg','jpeg','png','webp'].includes(ext)){const img=new Image(); img.src=path;}
  }
  sections.forEach(s=> s.media && preload(s.media));

  function setBackground(sec){
    const t=sec.type;
    if(t==='video'){
      bgGrad.style.display='none'; bgImage.style.display='none'; bgVideo.style.display='block';
      if(bgVideo.getAttribute('src')!==sec.media){ bgVideo.src=sec.media; try{bgVideo.load();}catch(e){} }
      bgVideo.muted=true; bgVideo.play().catch(()=>{});
    }else if(t==='image'){
      try{bgVideo.pause();}catch(e){}; bgVideo.removeAttribute('src');
      bgGrad.style.display='none'; bgImage.style.display='block'; if(bgImage.getAttribute('src')!==sec.media){ bgImage.src=sec.media; }
    }else if(t==='gradient'){
      try{bgVideo.pause();}catch(e){}; bgVideo.removeAttribute('src');
      bgImage.style.display='none'; bgGrad.style.display='block';
    }
  }

  function renderSection(idx){
    const sec=sections[idx];
    setBackground(sec);

    // Reset common UI
    content.hidden=true; content.textContent='';
    titleEl.textContent=''; subtitle.textContent='';
    card.classList.remove('card--invisible');
    nextBtn.style.display='block';
    introOverlay.style.display='none';
    endOverlay.style.display='none';
    endOverlay.hidden = true;

    // Musik looping pada seluruh bagian kecuali bagian 0 (intro)
    if(idx !== 0) {
      try {
        bgAudio.loop = true;
        if(bgAudio.paused) {
          bgAudio.currentTime = 0;
          bgAudio.volume = 0.5;
          bgAudio.play().catch(function(e){
            console.error('Gagal memutar audio:', e);
          });
        }
      } catch(e){}
    } else {
      try { bgAudio.pause(); bgAudio.currentTime = 0; } catch(e){}
    }

    if(sec.kind==='intro'){
      // Section 0 — overlay only
      introTitle.textContent=sec.title || 'Hai, Dedek Rere';
      introSub.textContent=sec.subtitle || '- Abang Raja';
      introOverlay.style.display='flex';
      card.classList.add('card--invisible');
    } else if(sec.kind==='image'){
      // Section 5 — full image, keep only next button
      card.classList.add('card--invisible');
    } else if(sec.kind==='end'){
      // Section 6 — just the single word, no card, no button
      endOverlay.style.display='flex';
      endOverlay.hidden = false;
      card.classList.add('card--invisible');
      nextBtn.style.display='none';
      // Pasang event listener tombol Spotify setiap kali dirender
      const spotifyBtn = document.getElementById('spotifyBtn');
      if (spotifyBtn && !spotifyBtn.hasAttribute('data-listener')) {
        spotifyBtn.addEventListener('click', function() {
          window.open('https://open.spotify.com/playlist/1YFTqIfX6c5gOswRZ4GzcO?si=c5249c19fc4346bd', '_blank');
        });
        spotifyBtn.setAttribute('data-listener', 'true');
      }
    } else {
      // Text sections — normal card
      titleEl.textContent=sec.title || '';
      content.hidden=false; content.innerText=sec.body || '';
      nextBtn.textContent='Lanjut ➜';
    }

    hint.style.display=(idx===0)?'block':'none';
  }

  function goNext(){
    // setelah interaksi pertama, hapus overlay intro agar tidak pernah muncul lagi
    if(introOverlay && introOverlay.parentNode){ introOverlay.remove(); }
    // Tidak perlu play audio manual di sini, sudah di-handle di renderSection
    i=Math.min(i+1, sections.length-1);
    renderSection(i);
  }

  nextBtn.addEventListener('click',()=>{
    if(i===sections.length-1){ return; }
    goNext();
  });

  // (Event listener tombol Spotify dipasang di renderSection)
  // Init
  renderSection(0);
  // Autoplay muted video background if any
  setTimeout(()=>{ if(bgVideo && bgVideo.src){ bgVideo.muted=true; bgVideo.play().catch(()=>{}); }}, 60);
  </script>
</body>
</html>